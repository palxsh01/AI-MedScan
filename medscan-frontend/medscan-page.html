<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel = "icon" type = "image" href = "medscan-icon.ico">
    <title>MedScan - AI Healthcare Solutions</title>
    <link rel="stylesheet" href="medscan-styles.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
</head>
<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>Med<span style="color: #bfdbfe;">Scan</span></h2>
            <p>AI-Powered Healthcare</p>
        </div>
        <div class="nav-buttons">
            <a href="#" class="nav-button active" id="homeBtn">
                <i class="fas fa-home"></i> HOME
            </a>
            <a href="login.html" class="nav-button" id="loginBtn">
                <i class="fas fa-sign-in-alt"></i> LOGIN
            </a>
            <a href="help.html" class="nav-button" id="helpBtn">
                <i class="fas fa-question-circle"></i> HELP
            </a>
            <a href="about.html" class="nav-button" id="aboutBtn">
                <i class="fas fa-info-circle"></i> ABOUT US
            </a>
            <a href="contact.html" class="nav-button" id="contactBtn">
                <i class="fas fa-envelope"></i> CONTACT
            </a>
        </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
        <div class="header">
            <div class="logo">
                <i class="fas fa-brain logo-icon"></i>Med<span>Scan</span>
            </div>
            <div class="user-actions">
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i> Dark Mode
                </button>
                <button class="btn btn-outline-primary btn-sm">Sign Up</button>
            </div>
        </div>

        <!-- Hero Section -->
        <div class="hero-section">
            <h1>Welcome to MedScan AI Assistant</h1>
            <p>Your intelligent healthcare companion powered by advanced artificial intelligence. Get instant medical information and preliminary assessments.</p>
            <button class="btn btn-primary">Get Started</button>
        </div>

        <!-- Features Section -->
        <div class="features">
            <div class="feature-card">
                <i class="fas fa-robot feature-icon"></i>
                <h3>AI-Powered Analysis</h3>
                <p>Advanced machine learning algorithms for accurate medical assessments.</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-heartbeat feature-icon"></i>
                <h3>Health Monitoring</h3>
                <p>Real-time tracking of vital signs and health indicators.</p>
            </div>
            <div class="feature-card">
                <i class="fas fa-user-md feature-icon"></i>
                <h3>Expert Support</h3>
                <p>Connect with healthcare professionals for detailed consultations.</p>
            </div>
        </div>

        <!-- Medical Tools Section -->
        <div class="medical-tools">
            <div class="tool-card" id="symptomChecker">
                <i class="fas fa-stethoscope"></i>
                <h3>Symptom Checker</h3>
                <p>Get preliminary analysis of your symptoms</p>
            </div>
            <div class="tool-card" id="medicationLookup">
                <i class="fas fa-pills"></i>
                <h3>Medication Info</h3>
                <p>Look up information about medications</p>
            </div>
        </div>
    </div>

    <!-- Symptom Checker Modal -->
    <div class="modal fade" id="symptomModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Symptom Checker</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <strong>Disclaimer:</strong> This is not a substitute for professional medical advice. Always consult a doctor for serious symptoms.
                    </div>
                    <textarea id="symptomInput" class="form-control" rows="5" placeholder="Describe your symptoms in detail (e.g., headache, fever, nausea)"></textarea>
                    <div id="symptomResult" class="mt-3" style="display: none;"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="analyzeSymptoms">Analyze Symptoms</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Medication Lookup Modal -->
    <div class="modal fade" id="medicationModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Medication Information</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <strong>Disclaimer:</strong> This information is for educational purposes only. Always follow your doctor's instructions.
                    </div>
                    <input type="text" id="medicationInput" class="form-control mb-3" placeholder="Enter medication name (e.g., Ibuprofen, Amoxicillin)">
                    <div id="medicationResult" class="mt-3" style="display: none;"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="lookupMedication">Look Up Medication</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chatbot Toggle Button -->
    <div class="chatbot-toggle" id="chatbotToggle">
        <i class="fas fa-robot"></i>
    </div>

    <!-- Chatbot Container -->
    <div class="chatbot-container" id="chatbotContainer">
        <div class="chatbot-header">
            <div class="chatbot-title">
                <i class="fas fa-robot"></i>
                <span>MedScan AI Assistant</span>
            </div>
            <i class="fas fa-times" id="chatbotClose" style="cursor: pointer;"></i>
        </div>
        <div class="chatbot-messages" id="chatbotMessages">
            <div class="message">
                <div class="bot-message">
                    Hello! I'm your MedScan AI Assistant. I can help with:
                    <ul>
                        <li>General health information</li>
                        <li>Symptom explanations</li>
                        <li>Medication details</li>
                    </ul>
                    <strong>Note:</strong> I don't provide diagnoses. For medical emergencies, call emergency services.
                </div>
            </div>
        </div>
        <div class="chatbot-input">
            <input type="text" id="userInput" placeholder="Type your health question..." />
            <button id="sendMessage">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Dark mode toggle functionality
            const themeToggle = document.getElementById('themeToggle');
            const htmlElement = document.documentElement;
            const moonIcon = '<i class="fas fa-moon"></i> Dark Mode';
            const sunIcon = '<i class="fas fa-sun"></i> Light Mode';

            // Check for saved theme preference
            if (localStorage.getItem('theme') === 'dark') {
                htmlElement.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = sunIcon;
            }

            themeToggle.addEventListener('click', function() {
                if (htmlElement.getAttribute('data-theme') === 'dark') {
                    htmlElement.removeAttribute('data-theme');
                    localStorage.setItem('theme', 'light');
                    themeToggle.innerHTML = moonIcon;
                } else {
                    htmlElement.setAttribute('data-theme', 'dark');
                    localStorage.setItem('theme', 'dark');
                    themeToggle.innerHTML = sunIcon;
                }
            });
            
            // Navigation Button Logic
            const navButtons = document.querySelectorAll('.nav-button');
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });

            // Chatbot functionality
            const chatbotToggle = document.getElementById('chatbotToggle');
            const chatbotContainer = document.getElementById('chatbotContainer');
            const chatbotClose = document.getElementById('chatbotClose');
            const chatbotMessages = document.getElementById('chatbotMessages');
            const userInput = document.getElementById('userInput');
            const sendMessage = document.getElementById('sendMessage');

            // Chatbot toggle functionality
            chatbotToggle.addEventListener('click', () => {
                chatbotContainer.classList.add('visible');
                chatbotToggle.classList.add('hidden');
                userInput.focus();
            });

            chatbotClose.addEventListener('click', () => {
                chatbotContainer.classList.remove('visible');
                setTimeout(() => {
                    chatbotToggle.classList.remove('hidden');
                }, 300);
            });

            // Basic responses database
            const chatbotResponses = {
                greetings: {
                    patterns: ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'good evening'],
                    responses: [
                        "Hello! How can I help you with your health questions today?",
                        "Hi there! I'm here to provide basic health information. What would you like to know?",
                        "Hello! I'm your MedScan assistant. How may I help you?"
                    ]
                },
                goodbye: {
                    patterns: ['bye', 'goodbye', 'see you', 'thanks bye', 'good night'],
                    responses: [
                        "Goodbye! Take care of your health!",
                        "Have a great day! Remember to stay healthy!",
                        "Goodbye! Don't hesitate to return if you have more questions!"
                    ]
                },
                thanks: {
                    patterns: ['thank you', 'thanks', 'appreciate it', 'helpful'],
                    responses: [
                        "You're welcome! Your health is our priority.",
                        "Glad I could help! Remember, this is just general information.",
                        "Happy to help! Remember to consult healthcare professionals for medical advice."
                    ]
                },
                emergency: {
                    patterns: ['emergency', 'severe pain', 'heart attack', 'stroke', 'cant breathe', "can't breathe", 'unconscious'],
                    responses: [
                        "âš ï¸ This sounds like a medical emergency. Please call emergency services (911 or your local emergency number) immediately. Do not wait for online advice.",
                        "ðŸš¨ EMERGENCY: Please call emergency services right away. This requires immediate medical attention.",
                        "âš ï¸ URGENT: Contact emergency services now. This is not something to handle through a chat system."
                    ]
                },
                symptoms: {
                    patterns: ['what are the symptoms', 'symptoms of', 'signs of', 'how do i know if'],
                    responses: [
                        "To check specific symptoms, please use our Symptom Checker tool. Would you like me to open it for you?",
                        "I can help you check symptoms using our dedicated Symptom Checker. Should I open it?",
                        "For accurate symptom analysis, let's use our Symptom Checker tool. Would you like to try it?"
                    ]
                },
                medications: {
                    patterns: ['medicine', 'drug', 'medication', 'prescription', 'pill'],
                    responses: [
                        "For medication information, please use our Medication Lookup tool. Would you like me to open it?",
                        "I can help you find medication details using our Medication Lookup. Should I open it?",
                        "Let's check our Medication Database for that information. Would you like me to open the lookup tool?"
                    ]
                },
                general_health: {
                    patterns: ['healthy lifestyle', 'health tips', 'how to stay healthy', 'wellness'],
                    responses: [
                        "Here are some basic health tips:\nâ€¢ Exercise regularly\nâ€¢ Eat a balanced diet\nâ€¢ Get enough sleep\nâ€¢ Stay hydrated\nâ€¢ Manage stress\nâ€¢ Have regular check-ups",
                        "Some key aspects of staying healthy:\nâ€¢ Regular physical activity\nâ€¢ Nutritious diet\nâ€¢ Adequate sleep\nâ€¢ Stress management\nâ€¢ Regular medical check-ups",
                        "Important health habits:\nâ€¢ Daily exercise\nâ€¢ Balanced nutrition\nâ€¢ 7-9 hours sleep\nâ€¢ Proper hydration\nâ€¢ Mental wellness\nâ€¢ Preventive care"
                    ]
                },
                default: {
                    responses: [
                        "I'm not sure I understand. Could you rephrase that? Or would you like to try our Symptom Checker or Medication Lookup tools?",
                        "I'm limited in my responses. Would you like to use our Symptom Checker or Medication Lookup tools instead?",
                        "I may not have the specific information you're looking for. Please try our medical tools or consult a healthcare professional."
                    ]
                }
            };

            function findBestResponse(message) {
                message = message.toLowerCase();
                
                // Check for emergency keywords first
                if (chatbotResponses.emergency.patterns.some(pattern => message.includes(pattern))) {
                    return getRandomResponse(chatbotResponses.emergency.responses);
                }

                // Check all other patterns
                for (const category in chatbotResponses) {
                    if (category !== 'default' && chatbotResponses[category].patterns) {
                        if (chatbotResponses[category].patterns.some(pattern => message.includes(pattern))) {
                            return getRandomResponse(chatbotResponses[category].responses);
                        }
                    }
                }

                // If no match found, return default response
                return getRandomResponse(chatbotResponses.default.responses);
            }

            function getRandomResponse(responses) {
                return responses[Math.floor(Math.random() * responses.length)];
            }

            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'message';
                typingDiv.innerHTML = `
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                `;
                chatbotMessages.appendChild(typingDiv);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
                return typingDiv;
            }

            function removeTypingIndicator(typingDiv) {
                typingDiv.remove();
            }

            function addMessage(message, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.innerHTML = `<div class="${isUser ? 'user-message' : 'bot-message'}">${message}</div>`;
                chatbotMessages.appendChild(messageDiv);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }

            sendMessage.addEventListener('click', () => {
                const message = userInput.value.trim();
                if (message) {
                    addMessage(message, true);
                    userInput.value = '';
                    
                    const typingDiv = showTypingIndicator();
                    
                    // Simulate typing delay
                    setTimeout(() => {
                        removeTypingIndicator(typingDiv);
                        const response = findBestResponse(message);
                        addMessage(response);

                        // If response mentions tools, show them
                        if (response.includes('Symptom Checker')) {
                            setTimeout(() => symptomModal.show(), 1000);
                        } else if (response.includes('Medication Lookup')) {
                            setTimeout(() => medicationModal.show(), 1000);
                        }
                    }, 1000);
                }
            });

            userInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage.click();
                }
            });

            // Medical Tools Functionality
            const symptomChecker = document.getElementById('symptomChecker');
            const medicationLookup = document.getElementById('medicationLookup');
            const symptomModal = new bootstrap.Modal(document.getElementById('symptomModal'));
            const medicationModal = new bootstrap.Modal(document.getElementById('medicationModal'));

            // Reset symptom checker when modal is closed
            document.getElementById('symptomModal').addEventListener('hidden.bs.modal', function () {
                document.getElementById('symptomInput').value = '';
                document.getElementById('symptomResult').style.display = 'none';
                document.getElementById('symptomResult').innerHTML = '';
                document.getElementById('analyzeSymptoms').disabled = false;
                document.getElementById('analyzeSymptoms').textContent = 'Analyze Symptoms';
            });

            // Reset medication lookup when modal is closed
            document.getElementById('medicationModal').addEventListener('hidden.bs.modal', function () {
                document.getElementById('medicationInput').value = '';
                document.getElementById('medicationResult').style.display = 'none';
                document.getElementById('medicationResult').innerHTML = '';
                document.getElementById('lookupMedication').disabled = false;
                document.getElementById('lookupMedication').textContent = 'Look Up Medication';
            });

            symptomChecker.addEventListener('click', () => {
                symptomModal.show();
            });

            medicationLookup.addEventListener('click', () => {
                medicationModal.show();
            });

            // Symptom Analysis
            document.getElementById('analyzeSymptoms').addEventListener('click', async () => {
                const symptoms = document.getElementById('symptomInput').value.trim();
                if (!symptoms) return;
                
                const analyzeBtn = document.getElementById('analyzeSymptoms');
                const resultDiv = document.getElementById('symptomResult');
                
                analyzeBtn.disabled = true;
                analyzeBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Analyzing...';
                resultDiv.style.display = 'block';
                resultDiv.innerHTML = '<div class="alert alert-info">Analyzing symptoms...</div>';
                
                try {
                    const userSymptoms = symptoms.split(',').map(s => s.trim().toLowerCase());
                    const matchingDiseases = window.symptomDatabase
                        .map(entry => {
                            const matchCount = entry.symptoms.filter(symptom => 
                                userSymptoms.some(userSymp => 
                                    symptom.toLowerCase().includes(userSymp) || 
                                    userSymp.includes(symptom.toLowerCase())
                                )
                            ).length;
                            return { ...entry, matchCount };
                        })
                        .filter(entry => entry.matchCount > 0)
                        .sort((a, b) => b.matchCount - a.matchCount)
                        .slice(0, 3);

                    if (matchingDiseases.length > 0) {
                        const diseaseList = matchingDiseases
                            .map((entry) => `
                                <div class="disease-entry mb-3">
                                    <h6 class="mb-2">${entry.disease}</h6>
                                    <p class="mb-1"><strong>Matching Symptoms:</strong> ${entry.matchCount}</p>
                                    <p class="mb-1"><strong>Description:</strong> ${entry.description}</p>
                                    <p class="mb-1"><strong>Recommended Actions:</strong> ${entry.recommendations}</p>
                                </div>
                            `)
                            .join('');
                        
                        resultDiv.innerHTML = `
                            <div class="alert alert-info">
                                <h5>Analysis Results</h5>
                                <div class="disease-list">${diseaseList}</div>
                                <hr>
                                <div class="disclaimer">
                                    <p class="text-danger"><strong>Important Disclaimer:</strong></p>
                                    <ul>
                                        <li>This is not a diagnosis</li>
                                        <li>Results are based on general medical knowledge</li>
                                        <li>Always consult a healthcare professional for proper evaluation</li>
                                        <li>For medical emergencies, call emergency services immediately</li>
                                    </ul>
                                </div>
                            </div>
                        `;
                    } else {
                        resultDiv.innerHTML = `
                            <div class="alert alert-warning">
                                <h5>No Matching Conditions Found</h5>
                                <p>We couldn't find any conditions matching your symptoms. This could be because:</p>
                                <ul>
                                    <li>The symptoms are too general</li>
                                    <li>More specific information is needed</li>
                                    <li>The condition is rare or not in our database</li>
                                </ul>
                                <p>Please consult a healthcare professional for proper evaluation.</p>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Error:', error);
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <h5>Error Analyzing Symptoms</h5>
                            <p>We encountered an error while analyzing your symptoms. Please try again.</p>
                        </div>
                    `;
                } finally {
                    analyzeBtn.disabled = false;
                    analyzeBtn.textContent = 'Analyze Symptoms';
                }
            });

            // Medication Lookup
            document.getElementById('lookupMedication').addEventListener('click', () => {
                const medication = document.getElementById('medicationInput').value.trim();
                if (!medication) return;
                
                const lookupBtn = document.getElementById('lookupMedication');
                const resultDiv = document.getElementById('medicationResult');
                
                lookupBtn.disabled = true;
                lookupBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Searching...';
                resultDiv.style.display = 'block';
                
                try {
                    const matchingMed = window.medicationDatabase.find(
                        med => med.name.toLowerCase() === medication.toLowerCase()
                    );
                    
                    if (matchingMed) {
                        resultDiv.innerHTML = `
                            <div class="alert alert-info">
                                <h5>${matchingMed.name}</h5>
                                <p><strong>Description:</strong> ${matchingMed.description}</p>
                                <p><strong>Dosage:</strong> ${matchingMed.dosage}</p>
                                <p><strong>Side Effects:</strong> ${matchingMed.sideEffects}</p>
                                ${matchingMed.warnings ? `<p><strong>Warnings:</strong> ${matchingMed.warnings}</p>` : ''}
                                <hr>
                                <p class="text-danger"><strong>Important:</strong> Always follow your doctor's prescription and instructions.</p>
                            </div>
                        `;
                    } else {
                        resultDiv.innerHTML = `
                            <div class="alert alert-warning">
                                <h5>Medication Not Found</h5>
                                <p>We couldn't find information about "${medication}" in our database.</p>
                                <p>Please check the spelling or consult your healthcare provider.</p>
                            </div>
                        `;
                    }
                } catch (error) {
                    console.error('Error:', error);
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <h5>Error Looking Up Medication</h5>
                            <p>We encountered an error while looking up the medication. Please try again.</p>
                        </div>
                    `;
                } finally {
                    lookupBtn.disabled = false;
                    lookupBtn.textContent = 'Look Up Medication';
                }
            });

            // Auto-focus on input when chatbot opens
            document.addEventListener('click', function(e) {
                if (e.target === chatbotToggle || e.target.closest('#chatbotContainer')) {
                    setTimeout(() => {
                        userInput.focus();
                    }, 100);
                }
            });
        });
    </script>
    <script src="databases.js"></script>
</body>
</html>